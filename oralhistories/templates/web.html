<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
$for(author-meta)$
  <meta name="author" content="$author-meta$">
$endfor$
$if(date-meta)$
  <meta name="dcterms.date" content="$date-meta$">
$endif$
$if(keywords)$
  <meta name="keywords" content="$for(keywords)$$keywords$$sep$, $endfor$">
$endif$
$if(description-meta)$
  <meta name="description" content="$description-meta$">
$endif$
  <title>$if(title-prefix)$$title-prefix$ â€“ $endif$$pagetitle$</title>
$for(css)$
  <link rel="stylesheet" href="$css$">
$endfor$
<link rel="stylesheet" href="https://unpkg.com/@picocss/pico@latest/css/pico.min.css">
<link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700&family=Montserrat:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
<style>
  /* layout */
  figure {
    text-align: center;
  }
  @media (min-width: 992px) {
    main > *:not(header, nav, h3) {
      margin-inline: 20%;
      max-width: 50%;
      padding-inline: var(--spacing);
    }
    main > header {
      overflow: auto;
    }
    main > header > :not(h1, figure) {
      margin-inline-start: calc(33% + var(--block-spacing-horizontal) * 2);
      margin-inline-end: auto;
      max-width: fit-content;
    }
    main > header > figure {
      float: left;
      max-width: 33%;
    }
    main > nav[role="doc-toc"] {
      clear: right;
      float: right;
      max-width: 30%;
      padding-inline-start: var(--block-spacing-horizontal);
    }
    main > h3 {
      clear: left;
      float: left;
      max-width: 20%;
      padding-inline-end: var(--block-spacing-horizontal);
    }
  }
</style>
<style>
  /* table of contents */
  html {
    scroll-behavior: smooth;
  }
  /* sticky */
  @media (min-width: 992px) {
    nav[role="doc-toc"] {
      max-height: 100vh;
      overflow-y: auto;
      position: sticky;
      top: 0;
    }
  }
  /* override pico nav https://picocss.com/docs/navs.html */
  /* nav with role=doc-toc useful for accessibility */
  /* https://www.w3.org/TR/dpub-aria-1.1/#doc-toc */
  nav[role="doc-toc"] ul {
    display: block;
    padding-inline-start: var(--spacing);
  }
  nav[role="doc-toc"] ul:first-of-type {
    margin-inline-start: 0;
  }
  nav[role="doc-toc"] ul:last-of-type {
    margin-inline-end: 0;
  }
  nav[role="doc-toc"] li {
    display: list-item;
    padding: 0;
  }
  nav[role="doc-toc"] li > * {
    --spacing: 1rem;
  }
  nav[role="doc-toc"] li ul {
    margin-block-start: 0;
  }
  nav[role="doc-toc"] a {
    display: inline;
  }
</style>
<style>
  /* scrollspy */
  nav[role="doc-toc"] li.active > a {
    color: var(--primary-hover);
    font-weight: bold;
  }
</style>
<style>
  :root {
    --font-family: 'Montserrat', sans-serif;;
    /* disable responsive typography */
    --font-size: unset;
  }
  h1, h2, h3, nav {
    font-family: 'Merriweather', serif;
  }
  nav ul {
    font-weight: 300;
    margin-block-start: 0.5em;
  }
  nav li {
    margin-block-end: 0.5em;
  }
  figcaption {
    font-size: smaller;
  }
  p {
    line-height: 1.75;
  }
  @media (min-width: 992px) {
    main > h3 {
      font-size: 1rem;
    }
  }
  .smallcaps {
    font-variant: small-caps;
    font-weight: bold;
  }
</style>
$for(header-includes)$
  $header-includes$
$endfor$
</head>
<body>
<main class="container">
$for(include-before)$
$include-before$
$endfor$
$if(title)$
<header id="title-block-header">
<h1 class="title">$title$</h1>
$if(subtitle)$
<p class="subtitle">$subtitle$</p>
$endif$
$for(author)$
<p class="author">$author$</p>
$endfor$
$if(date)$
<p class="date">$date$</p>
$endif$
$if(interviewer)$
<div class="interviewer-wrapper">Interviewed by <span class="interviewer">$interviewer$</span></div>
$endif$
$if(dates)$
<details>
  <summary>Interview Session Dates</summary>
  <ul>
    $for(dates)$
    <li>$dates$</li>
    $endfor$
  </ul>
</details>
$endif$
$if(abstract)$
<h2>$abstract-title$</h2>
<p>$abstract$</p>
$endif$
$if(archival_object_uri)$
<!--TODO set up variable for base URL-->
<div><a href="https://collections.archives.caltech.edu$archival_object_uri$">Access the full archival record</a></div>
$endif$
$if(component_id)$
<!--TODO set up variable for base URL-->
<div><a id="pdf" href="https://test-oralhistories-static-site.s3.us-west-2.amazonaws.com/$component_id$/$component_id$.pdf">Access a PDF version of the transcript</a></div>
$endif$
</header>
$endif$
$if(toc)$
<nav id="$idprefix$TOC" role="doc-toc">
$if(toc-title)$
<h2 id="$idprefix$toc-title">$toc-title$</h2>
$endif$
$table-of-contents$
</nav>
$endif$
$body$
$for(include-after)$
$include-after$
$endfor$
</main>
<script>
  // set img alt attributes differently than pandoc for better accessibility
  document.querySelectorAll("figure img").forEach(img => {
    if (img.getAttribute("title")) {
      img.setAttribute("alt", img.getAttribute("title"));
      img.removeAttribute("title");
    }
    if (img.nextElementSibling) {
      img.nextElementSibling.removeAttribute("aria-hidden");
    }
  });
  // move frontispiece into header area
  document.querySelector("#title-block-header h1").insertAdjacentElement("afterend", document.getElementById("frontispiece").parentElement);
  // append file size to pdf links
  const pdf_link = document.getElementById("pdf");
  fetch(pdf_link.href, {method: "HEAD"}).then((response) => {
    const bytes = response.headers.get('content-length');
    // NOTE: double dollar sign because this is a pandoc template
    pdf_link.insertAdjacentText("beforeend", ` [$${humanFileSize(bytes)}]`);
  });
  function humanFileSize(size) {
    var i = size == 0 ? 0 : Math.floor(Math.log(size) / Math.log(1024));
    return (size / Math.pow(1024, i)).toFixed(2) * 1 + ' ' + ['B', 'kB', 'MB', 'GB', 'TB'][i];
  };
  // scrollspy
  window.addEventListener('DOMContentLoaded', () => {
    const observer = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        const id = entry.target.getAttribute('id');
        if (entry.intersectionRatio > 0) {
          // NOTE: double dollar sign because this is a pandoc template
          document.querySelector(`nav li a[href="#$${id}"]`).parentElement.classList.add('active');
          if (item.parentElement.parentElement.tagName == "NAV" && item.previousElementSibling) {
            // remove class from top-level LI & its last child LI
            item.previousElementSibling.classList.remove("active");
            item.previousElementSibling.lastElementChild.lastElementChild.classList.remove("active");
          }
          if (item.parentElement.parentElement.parentElement.parentElement.tagName == "NAV" && item.previousElementSibling) {
            // remove class from previous item only after setting new class
            item.previousElementSibling.classList.remove("active");
          }
        }
      });
    });
    // Track all headings that have an `id` applied
    document.querySelectorAll('h2[id], h3[id').forEach((heading) => {
      observer.observe(heading);
    });
  });
  // TODO scroll toc with page contents to keep current toc item in viewport
</script>
</body>
</html>
